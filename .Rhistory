geom_point() +
geom_errorbar(aes(ymin=B-BDS,ymax=B+BDS), width = 0.2)+
theme_bw()+
labs(x="Año", y="Biomasa (gramos / transecto)")+
scale_color_brewer(palette = "Set1")
min(B$B)
min(B$BDS)
B <- datos %>%
group_by(Ano, Zonificacion, Sitio, Transecto) %>%
summarize(B1 = sum(Biomasa)) %>%
group_by(Ano, Zonificacion, Sitio) %>%
summarize(B = mean(B1, na.rm=T), BDS = sd(B1, na.rm=T))
ggplot(data = B, aes(x = Ano, y = B, col = Zonificacion, factor = Sitio))+
geom_line()+
geom_point(aes(pch = Sitio)) +
geom_errorbar(aes(ymin=B-BDS,ymax=B+BDS), width = 0.2)+
theme_bw()+
labs(x="Año", y="Biomasa (gramos / transecto)")+
scale_color_brewer(palette = "Set1")
library(dplyr)
?complete
library(tidyr)
?complete
suppressPackageStartupMessages({
library(ggplot2)
library(dplyr)
library(tidyr)
library(MPAtools)
})
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(fill = list(0))
13764
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(GeneroEspecie, fill = list(0))
colnames(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(GeneroEspecie)
df <- data_frame(
group = c(1:2, 1),
item_id = c(1:2, 2),
item_name = c("a", "b", "b"),
value1 = 1:3,
value2 = 4:6
)
df
df
df %>% complete(group, nesting(item_id, item_name))
View(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
df
df %>% complete(group, nesting(item_id, item_name))
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(nesting(Ano, Sitio, Transecto), fill = list(Abundancia = 0))
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(nesting(Ano, Sitio, Transecto), GeneroEspecie, fill = list(Abundancia = 0))
View(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
colnames(datos)
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie), GeneroEspecie, fill = list(Abundancia = 0))
View(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie), GeneroEspecie, fill = list(Abundancia = 0)) %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto), GeneroEspecie, fill = list(Abundancia = 0)) %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
View(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Ano, Sitio, Transecto)) %>%
complete(id, GeneroEspecie, fill = list(Abundancia = 0)) %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
df
df %>% complete(group, nesting(item_id, item_name))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(GeneroEspecie, nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie), fill = list(Abundancia = 0))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(GeneroEspecie, nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto), fill = list(Abundancia = 0))
max(datos$Abundancia)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, GeneroEspecie), fill = list(Abundancia = 0))
View(datos)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))%>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, GeneroEspecie), fill = list(Abundancia = 0))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))%>%
complete(nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, GeneroEspecie), id, fill = list(Abundancia = 0))
df
df %>% complete(group, item_id)
df %>% complete(group, nesting(item_id, item_name))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(GeneroEspecie, nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie), fill = list(Abundancia = 0))
View(datos)
df
df %>% complete(group, nesting(item_id, item_name))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")
datos2=datos
datos2 = datos 2 %>% complete(GeneroEspecie)
datos2 = datos2 %>% complete(GeneroEspecie)
View(datos2)
datos2 = datos2 %>% complete(Ano, GeneroEspecie)
datos2 = datos %>%
select(Dia, Mes, Ano, Sitio, Transecto, Genero, Especie, GeneroEspecie, Talla, Abundancia)
datos2 = datos2 %>% complete(GeneroEspecie, nesting(Dia, Mes, Ano, Sitio, Transecto, Genero, Especie), fill = list(Abundancia = 0, Talla = NA))
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(Dia, Mes, Ano, Sitio, Transecto, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(GeneroEspecie, nesting(Dia, Mes, Ano, Sitio, Transecto, Genero, Especie), fill = list(Abundancia = 0, Talla = NA)) %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
untable(n = Abundancia)
colnames(datos)
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
complete(GeneroEspecie, nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie), fill = list(Abundancia = 0, Talla = NA)) %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
untable(n = Abundancia)
library(reshape)
rm(datos2)
rm(df)
df <- data_frame(
group = c(1:2, 1),
item_id = c(1:2, 2),
item_name = c("a", "b", "b"),
value1 = 1:3,
value2 = 4:6
)
df
df
df %>% complete(group, nesting(item_id, item_name))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto)) %>%
complete(id, nesting(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie, GeneroEspecie), fill = list(Abundancia = 0))
length(unique(datos$GeneroEspecie))
77*9*5
77*9*5*24
2+2
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto)) %>%
complete(id, c(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto, Genero, Especie, GeneroEspecie), fill = list(Abundancia = 0))
summary(datos)
df
df %>% complete(group, nesting(item_id, item_name))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(id, GeneroEspecie, Talla, Abundancia) %>%
complete(id, GeneroEspecie, fill = list(Talla = NA, Abundancia = 0))
datos2 <- datos %>%
select(id, GeneroEspecie, Talla, Abundancia) %>%
complete(id, GeneroEspecie, fill = list(Talla = NA, Abundancia = 0)) %>%
left_join(datos, by = "id")
View(datos2)
datos2 <- datos %>%
select(id, GeneroEspecie, Talla, Abundancia) %>%
complete(id, GeneroEspecie, fill = list(Talla = NA, Abundancia = 0))
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia)
View(datos)
View(datos3)
colnames(datos)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
left_join(datos2, by ="id")
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(id, nesting(Genero, Especie, GeneroEspecie), fill = list(Talla = NA, Abundancia = 0))
datos2 <- datos %>%
)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
left_join(datos2, by ="id")
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(n())
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
left_join(datos2, by ="id")
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
left_join(datos2, by ="id")
sum(is.na(datos3$Talla))
sum(is.na(datos3$Abundancia))
sum(is.na(datos3$GeneroEspecie))
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N)
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id")
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(id, nesting(Genero, Especie, GeneroEspecie), fill = list(Talla = NA, Abundancia = 0))
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id")
datos4 <- left_join(datos2, datos3, by = "id")
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N)
datos4 <- left_join(datos2, datos3, by = "id")
datos3 <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id")
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
rm(datos3)
rm(datos4)
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
untable(rep = Abundancia)
?untable
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(id, nesting(Genero, Especie, GeneroEspecie), fill = list(Talla = NA, Abundancia = 0))
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
untable(num = Abundancia)
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(id, nesting(Genero, Especie, GeneroEspecie), fill = list(Talla = NA, Abundancia = 0))
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia)) %>%
untable(num = datos$Abundancia)
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto)) %>%
filter(!Especie == "sp." | !Especie == "spp." | !Especie == "sp" | !Especie =="spp")
unique(datos$Especie)
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
unique(datos$Especie)
sum(datos$Especie == "spp")
sum(datos$Especie == "sp")
sum(datos$Especie == "dovii")
sum(datos$Especie == "sp", na.rm=T)
abnt <- read.csv("./Datos/12082016 ISPM Especifico.csv", sep = ";", stringsAsFactors = F) %>%
mutate(NT = as.numeric(NT), a = as.numeric(a), b=as.numeric(b))
datos <- read.csv("./Datos/peces_completado.csv", sep=";")%>%
mutate(id = paste(Dia, Mes, Ano, Sitio, Transecto))
datos2 <- datos %>%
select(id, Genero, Especie, GeneroEspecie, Talla, Abundancia) %>%
complete(id, nesting(Genero, Especie, GeneroEspecie), fill = list(Talla = NA, Abundancia = 0))
datos <- datos %>%
select(-GeneroEspecie, -Talla, -Abundancia, -Genero, -Especie) %>%
group_by(id, Dia, Mes, Ano, Estado, Comunidad, Sitio, Latitud, Longitud, Habitat, Zonificacion, TipoProteccion, ANP, BuzoMonitor, HoraInicial, HoraFinal, ProfundidadInicial, ProfundidadFinal, Temperatura, Visibilidad, Corriente, Transecto) %>%
summarize(N=n()) %>%
select(-N) %>%
full_join(datos2, by ="id") %>%
left_join(abnt, by = "GeneroEspecie") %>%
mutate(Talla = as.numeric(as.character(Talla)), Abundancia = as.numeric(as.character(Abundancia))) %>%
mutate(Biomasa = Abundancia*a*(Talla^b)) %>%
mutate(TransectNumber = Transecto, Site = Comunidad, Year = Ano, Zone = Zonificacion, SizeClass = Talla) %>%
filter(!is.na(Abundancia))
N <- datos %>%
group_by(Ano, Zonificacion, Transecto) %>%
summarize(N1=sum(Abundancia)) %>%
group_by(Ano, Zonificacion) %>%
summarize(N = mean(N1), NDS = sd(N1))
ggplot(data = N, aes(x = Ano, y = N, col = Zonificacion))+
geom_line()+
geom_point()+
geom_errorbar(aes(ymin=N-NDS,ymax=N+NDS), width = 0.2)+
theme_bw()+
labs(x="Año", y="Densidad (org / transecto)")+
scale_color_brewer(palette = "Set1")
N <- datos %>%
group_by(Ano, Zonificacion, Transecto) %>%
summarize(N1=sum(Abundancia)) %>%
group_by(Ano, Zonificacion) %>%
summarize(N = mean(N1), NDS = sd(N1))
ggplot(data = N, aes(x = Ano, y = N, col = Zonificacion))+
geom_line()+
geom_point()+
geom_errorbar(aes(ymin=N-NDS,ymax=N+NDS), width = 0.2)+
theme_bw()+
labs(x="Año", y="Densidad (org / transecto)")+
scale_color_brewer(palette = "Set1")
N
?aov
colnames(N)
mdel1 <- aov(N~Ano+Zonnificacion)
mdel1 <- aov(N~Ano+Zonnificacion, data = N)
mdel1 <- aov(N~Ano+Zonificacion, data = N)
model1
mdel1
summary(mdel1)
bartlet.test(N)
?bartlett.test()
bartlett.test(data = N, N ~ Ano+Zonificacion)
bartlett.test(data = N, N ~ Zonificacion)
bartlett.test(data = N, N ~ Ano)
?shapiro.test
shapiro.test(N$N)
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(N$N)
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(rnorm(100, mean = 5, sd = 3))
mdel1 <- aov(N~Ano+Zonificacion+Ano+Zonificacion, data = N)
mdel1 <- aov(N~Ano+Zonificacion+Ano*Zonificacion, data = N)
summary(mdel1)
library(corrplot)
corrplot(cor(N))
corrplot(cors(N))
corrplot(corr(N))
corrplot(cor(N))
cor(N)
cor(N$N)
cor(N$N, N$Ano)
corrplot(cor(data=N))
mdel1 <- aov(N~Ano*Zonificacion, data = N)
TestFix <- drop1(mdel1, ~., test = “F”)
TestFix <- drop1(mdel1, ~., test = "F")
TestFix
baja_data=read.csv("./Biophys/Raw/baja_fish.csv") #Load fish data for Baja
did(N)
did
did(N)
colnames(N)
N
colnames(N) = c("Year", "Zone", "N", "NDS")
did(N, year.imp=2007)
colnames(N)
write.csv(datos, file = "peces_abundancias.csv", row.names = F)
# Chunk 1: setup
knitr::opts_chunk$set(echo = F, fig.height = 3, warning = F)
# Chunk 2
suppressPackageStartupMessages({
library(ggplot2)
library(dplyr)
library(tidyr)
library(MPAtools)
library(reshape)
})
