NT_R <- NT %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de no Pesca ")
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT2, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
# Para zonas de pesca
NT_P <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de Pesca ")
rows <- unique(NT_P$NT)
NT_P <- as.data.frame(NT_P[-1])
rownames(NT_P) <- rows
pro.NT_P<- prop.table(as.matrix(NT_P),2)
XsqP <- chisq.test(pro.NT_P)
print(XsqP)
# Para zonas de no pesca
NT_R <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de no Pesca ")
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT_P <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
spread(Ano, Abundancia)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
spread(Ano, Abundancia)
colnames(NT2)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
colnames(NT2)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia) %>%
spread(Ano, Abundancia)
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion)
rm(NT_P)
rm(NT2)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
NT_P
NT_R <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de no Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT2, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
# Para zonas de pesca
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
rows <- unique(NT_P$NT)
NT_P <- as.data.frame(NT_P[-1])
rownames(NT_P) <- rows
pro.NT_P<- prop.table(as.matrix(NT_P),2)
XsqP <- chisq.test(pro.NT_P)
print(XsqP)
# Para zonas de no pesca
NT_R <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de no Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT <- trophic(data = datos, location = "Bahia de Kino")
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
modelNTP
modelNTR
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
rm(fish_biomass)
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
datos <- datos %>%
mutate(TL = NT)
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
NTP
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT, na.rm = T)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTP
NT
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
?glmmadmb
install.packages("glmmADMB")
modelNR
summary(modelNR)
install.packages("glmmADMB")
library(MPAtools)
data(area1)
a <- mpa_sim(area1, 100, 0.5, 500, 1000, 0.3)
mpa_plot(a)
mpa_plot(a)
a <- mpa_sim(area1, 20, 0.5, 500, 1000, 0.3)
mpa_plot(a)
a <- mpa_sim(area1, 20, 0.5, 10, 1000, 0.3)
mpa_plot(a)
a <- mpa_sim(area1, 200, 0.5, 10, 1000, 0.3)
mpa_plot(a)
a <- mpa_sim(area1, 200, 0.5, 10, 1000, 0.5)
mpa_plot(a)
a <- mpa_sim(area1, 200, 0.5, 10, 1000, 0.5)
mpa_plot(a)
suppressPackageStartupMessages({
library(ggplot2)
library(dplyr)
library(tidyr)
library(MPAtools)
library(reshape)
library(stargazer)
library(ggExtra)
})
load("peces_objetivo.RData")
peces_objetivo <- filter(peces_objetivo, !is.na(Zonificacion)) %>%
mutate(W = Abundancia*a*(Talla^b)/1000) %>%
filer(Ano >= 2007)
peces_objetivo$W[is.na(peces_objetivo$W)] <- 0
load("peces_objetivo.RData")
peces_objetivo <- filter(peces_objetivo, !is.na(Zonificacion)) %>%
mutate(W = Abundancia*a*(Talla^b)/1000) %>%
filter(Ano >= 2007)
peces_objetivo$W[is.na(peces_objetivo$W)] <- 0
N <- peces_objetivo %>%
group_by(Ano, Zonificacion, GeneroEspecie) %>%
summarize(D = mean(Abundancia), DSD = sd(Abundancia))
ggplot(data = N, aes(x = Ano, y = D, color = Zonificacion))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymin = D-DSD, ymax = D+DSD))+
facet_wrap(~GeneroEspecie, ncol = 2, scales = "free_y")+
theme_bw()+
scale_color_brewer(palette = "Set1")
B <- peces_objetivo %>%
group_by(Ano, Zonificacion, GeneroEspecie) %>%
summarize(B = mean(W, na.rm=T), BSD = sd(W, na.rm = T))
ggplot(data = B, aes(x = Ano, y = B, color = Zonificacion))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymin = B-BSD, ymax = B+BSD))+
facet_wrap(~GeneroEspecie, ncol = 2, scales = "free_y")+
theme_bw()+
scale_color_brewer(palette = "Set1")
B <- peces_objetivo %>%
group_by(Ano, Zonificacion, GeneroEspecie) %>%
summarize(B = mean(W, na.rm=T), BSD = sd(W, na.rm = T))
ggplot(data = B, aes(x = Ano, y = B, color = Zonificacion))+
geom_point()+
geom_line()+
# geom_errorbar(aes(ymin = B-BSD, ymax = B+BSD))+
facet_wrap(~GeneroEspecie, ncol = 2, scales = "free_y")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
labs(x = "Año", y = "Biomasa (Kg / transecto)")
N <- peces_objetivo %>%
group_by(Ano, Zonificacion, GeneroEspecie) %>%
summarize(D = mean(Abundancia), DSD = sd(Abundancia))
ggplot(data = N, aes(x = Ano, y = D, color = Zonificacion))+
geom_point()+
geom_line()+
# geom_errorbar(aes(ymin = D-DSD, ymax = D+DSD))+
facet_wrap(~GeneroEspecie, ncol = 2, scales = "free_y")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
labs(x = "Año", y = "Densidad (org / transecto)")
H <- untable(peces_objetivo, num = Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram() +
facet_grid(Zonificacion~GeneroEspecie)
colnames(peces_objetivo)
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram() +
facet_grid(Zonificacion~GeneroEspecie)
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free_x")
?scales
?facet_grid
B <- peces_objetivo %>%
group_by(Ano, Zonificacion, GeneroEspecie) %>%
summarize(B = mean(W, na.rm=T), BSD = sd(W, na.rm = T))
ggplot(data = B, aes(x = Ano, y = B, color = Zonificacion))+
geom_point()+
geom_line()+
# geom_errorbar(aes(ymin = B-BSD, ymax = B+BSD))+
facet_wrap(~GeneroEspecie, ncol = 2, scales = "free")+
theme_bw()+
scale_color_brewer(palette = "Set1")+
labs(x = "Año", y = "Biomasa (Kg / transecto)")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free_x")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5, aes(color = Ano, alpha = 0.5)) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla)) +
geom_histogram(binwidth = 5, aes(color = Ano), alpha = 0.5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla, color = Ano)) +
geom_histogram(binwidth = 5, alpha = 0.5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla, color = Ano, factor = Ano)) +
geom_histogram(binwidth = 5, alpha = 0.5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla, color = Ano, factor = Ano)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
ggplot(H, aes(x = Talla, color = Ano, factor = Ano, fill = Ano)) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Talla, color = Ano, factor = as.factor(Ano))) +
geom_histogram(binwidth = 5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
?geom_histogram
library(hexbin)
HexPlot=hexbin(H$Talla, H$Ano, xbins=30)
plot(HexPlot)
HexPlot=hexbin(H$Ano, H$Talla, xbins=30)
plot(HexPlot)
HexPlot
summary(HexPLot)
?hexbin
set.seed(101)
x <- rnorm(10000)
y <- rnorm(10000)
(bin <- hexbin(x, y))
## or
plot(hexbin(x, y + x*(x+1)/4),
main = "(X, X(X+1)/4 + Y)  where X,Y ~ rnorm(10000)")
set.seed(101)
x <- rnorm(10000)
y <- rnorm(10000)
(bin <- hexbin(x, y))
## or
plot(hexbin(x, y + x*(x+1)/4),
main = "(X, X(X+1)/4 + Y)  where X,Y ~ rnorm(10000)")
set.seed(101)
x <- rnorm(10000)
y <- rnorm(10000)
(bin <- hexbin(x, y))
## or
plot(hexbin(x, y + x*(x+1)/4),
main = "(X, X(X+1)/4 + Y)  where X,Y ~ rnorm(10000)")
set.seed(101)
x <- rnorm(10000)
y <- rnorm(10000)
(bin <- hexbin(x, y))
## or
plot(hexbin(x, y + x*(x+1)/4),
main = "(X, X(X+1)/4 + Y)  where X,Y ~ rnorm(10000)")
x <- rnorm(10000)
y <- rnorm(10000)
(bin <- hexbin(x, y))
## or
plot(hexbin(x, y + x*(x+1)/4),
main = "(X, X(X+1)/4 + Y)  where X,Y ~ rnorm(10000)")
hbi <- hexbin(y ~ x, xbins = 80, IDs= TRUE)
str(hbi)
tI <- table(hbi@cID)
stopifnot(names(tI) == hbi@cell,
tI  == hbi@count)
x[runif(6, 0, length(x))] <- NA
y[runif(7, 0, length(y))] <- NA
hbN <- hexbin(x,y)
summary(hbN)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, factor = as.factor(Ano))) +
geom_jitter()
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, color = Zonificacion)) +
geom_jitter() +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, color = Ano)) +
geom_jitter() +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
ggplot(H, aes(x = Ano, y = Talla, color = Ano)) +
geom_jitter() +
geom_boxplot() +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot() +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot(aes(fill = "")) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot(alpha = 1)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot(alpha = 0)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot(alpha = 0.5)
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter() +
geom_boxplot(alpha = 0.5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter(pch = ".")
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, color = Ano, group = Ano)) +
geom_jitter(pch = ".") +
geom_boxplot(alpha = 0.5) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, group = Ano)) +
geom_jitter(pch = 1, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0) +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Talla, group = Ano)) +
geom_jitter(pch = 0.5, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0, outlier.color = "white") +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
ggplot(H, aes(x = Ano, y = Talla, group = Ano)) +
geom_jitter(size = 0, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0, outlier.color = "white") +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y =B, group = Ano)) +
geom_jitter(size = 0, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0, outlier.color = "white") +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
colnames(H)
H <- untable(peces_objetivo, num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y =W, group = Ano)) +
geom_jitter(size = 0, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0, outlier.color = "white") +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
peces_objetivo <- filter(peces_objetivo, !is.na(Zonificacion)) %>%
mutate(W = Abundancia*a*(Talla^b)/1000) %>%
filter(Ano >= 2007) %>%
untable(num = peces_objetivo$Abundancia)
ggplot(H, aes(x = Ano, y = Abundancia, group = Ano)) +
geom_jitter(size = 0, aes(color = Ano)) +
geom_boxplot(alpha = 0.5, outlier.size = 0, outlier.color = "white") +
facet_grid(GeneroEspecie~Zonificacion, scales = "free")+
theme_bw()
library(MPAtools)
load("Peces.Rdata")
datos <- datos %>%
mutate(TL = NT)
suppressPackageStartupMessages({
library(ggplot2)
library(dplyr)
library(tidyr)
library(MPAtools)
library(reshape)
library(stargazer)
library(ggExtra)
})
mpa_plot2(N)
N <- density(datos, "Bahia de Kino")
mpa_plot2(N)
2+2
colnames(N)
modelNp <- lm(N ~ Ano + Zonificacion, data = N)
N <- density(datos, "Bahia de Kino")
mpa_plot2(N)
modelNp <- lm(D ~ Ano + Zonificacion, data = N)
summary(modelNp)
