geom_point()
N
ggplot(data, aes(x = Ano, y = N, color = Zonificacion))+
geom_point()
suppressPackageStartupMessages({
library(ggplot2)
library(dplyr)
library(tidyr)
library(MPAtools)
library(reshape)
library(stargazer)
library(ggExtra)
})
S <- richness(data = datos, location = "Bahia de Kino")
mpa_plot2(S, "s")
mpa_plot2
library(MPAtools)
mpa_plot2
devtools::install_github("turfeffect/MPAtools")
devtools::install_github("turfeffect/MPAtools", force = T)
mpa_plot2
library(MPAtools)
mpa_plot2
library(MPAtools)
MPAtools::mpa_plot2(S, "s")
rm(mpa_plot2)
B <- fish_biomass(data = datos, location = "Bahia de Kino")
mpa_plot2(B, "b")
BP <- B %>%
group_by(Ano, Zonificacion) %>%
summarize(B = mean(W)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelBP <- lm(B ~ Ano, data = BP)
B <- fish_biomass(data = datos, location = "Bahia de Kino")
mpa_plot2(B, "b")
colnames(B)
BP <- B %>%
group_by(Ano, Zonificacion) %>%
summarize(B = mean(B)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelBP <- lm(B ~ Ano, data = BP)
modelBP
BP <- B %>%
group_by(Ano, Zonificacion) %>%
summarize(B = mean(B)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelBP <- lm(B ~ Ano, data = BP)
BR <- B %>%
group_by(Ano, Zonificacion) %>%
summarize(B = mean(B)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelBR <- lm(B ~ Ano, data = BR)
modelBR
modelBP
mpa_plot2()
mpa_plot2
B2 <- B %>% group_by(Ano, Zonificacion) %>% mutate(BSD = sd(B,
na.rm = T), B = mean(B, na.rm = T))
ggplot(B2, aes(x = Ano, y = B, color = Zonificacion)) +
geom_point() +
geom_line() +
theme_bw() +
scale_color_brewer(palette = "Set1")
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(B ~ Ano, data = NTP)
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
modelNTP
modelNTR
summary(modelNTP)
summary(modelNTR)
save(datos, file = "Peces.RData")
datos <- load("Peces.Rdata")
stargazer(Xs1)
stargazer(Xsq)
library(stargazer)
stargazer(Xsq)
Xsq
disp(Xsq)
print(Xsq)
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = floor(NT)) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia)) %>%
spread(Ano, Abundancia)
colnames(datos)
?save
load("Peces.Rdata")
datos <- load("Peces.RData")
load("Peces.RData")
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = floor(NT)) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia)) %>%
spread(Ano, Abundancia)
NT_P
pro2 <- pro.NT_P %>%
gather(Ano, Abundancia, -NT)
NT_P2 <- NT_P %>%
gather(Ano, Abundancia, -NT)
NT_P2
NT_P2
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = NT))+
geom_line()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = NT))+
geom_point()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = NT))+
geom_point()+
geom_line()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = NT, factor = NT))+
geom_point()+
geom_line()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = as.factor(NT)))+
geom_point()+
geom_line()
class(NT_P2)
NT_P2 <- NT_P %>%
gather(Ano, Abundancia, -NT) %>%
ungroup()
class(NT_P2)
NT_P2 <- NT_P %>%
gather(Ano, Abundancia, -NT) %>%
as.data.frame()
class(NT_P2)
NT_P2
ggplot(NT_P2, aes(x = Ano, y = Abundancia, color = as.factor(NT)))+
geom_point()+
geom_line()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, factor = NT))+
geom_point()+
geom_line()
NT_P2
ggplot(NT_P2, aes(x = Ano, y = Abundancia))+
geom_point()+
geom_line()
ggplot(NT_P2, aes(x = Ano, y = Abundancia, factor = NT))+
geom_point()+
geom_line()
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = floor(NT)) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P2, aes(x = Ano, y = Abundancia, factor = NT))+
geom_point()+
geom_line()
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = floor(NT)) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT))+
geom_point()+
geom_line()
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = fas.factor(loor(NT))) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(Zonificacion == "Zona de Pesca ") %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
mpa_plot2(N, "d")
N
MPAtools::mpa_plot2(N, "d")
N <- density(datos, "Bahia de Kino")
mpa_plot2(N, "d")
density
mpa_plot2
NT_P <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia)) %>%
ungroup()
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()
NT_P <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_line()+
facet_grid(.~Zonificacion)
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)
NT_P <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT_P, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
NT_P <- NT_P %>%
spread(Ano, Abundancia)
NT_P
rm(NT_P2)
NT_P
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT2, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
# Para zonas de pesca
NT_P <- NT %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de Pesca ")
rows <- unique(NT_P$NT)
NT_P <- as.data.frame(NT_P[-1])
rownames(NT_P) <- rows
pro.NT_P<- prop.table(as.matrix(NT_P),2)
XsqP <- chisq.test(pro.NT_P)
print(XsqP)
# Para zonas de no pesca
NT_R <- NT %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de no Pesca ")
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT2, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
# Para zonas de pesca
NT_P <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de Pesca ")
rows <- unique(NT_P$NT)
NT_P <- as.data.frame(NT_P[-1])
rownames(NT_P) <- rows
pro.NT_P<- prop.table(as.matrix(NT_P),2)
XsqP <- chisq.test(pro.NT_P)
print(XsqP)
# Para zonas de no pesca
NT_R <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de no Pesca ")
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT_P <- NT2 %>%
spread(Ano, Abundancia) %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
spread(Ano, Abundancia)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
spread(Ano, Abundancia)
colnames(NT2)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
colnames(NT2)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia) %>%
spread(Ano, Abundancia)
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(Ano, NT, Abundancia)
NT_P
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion)
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion)
rm(NT_P)
rm(NT2)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
NT_P <- NT2 %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ")
NT_P
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
NT_P
NT_R <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de no Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
NT2 <- datos %>%
filter(!is.na(NT)) %>%
filter(Abundancia > 0) %>%
mutate(NT = as.factor(floor(NT))) %>%
group_by(Ano, Zonificacion, Sitio, Transecto, NT) %>%
summarize(Abundancia = sum(Abundancia)) %>%
group_by(Ano, Zonificacion, NT) %>%
summarize(Abundancia = mean(Abundancia))
ggplot(NT2, aes(x = Ano, y = Abundancia, factor = NT, color = NT))+
geom_point()+
geom_line()+
theme_bw()+
facet_grid(.~Zonificacion)+
scale_color_brewer(palette = "Set1")
# Para zonas de pesca
NT_P <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
rows <- unique(NT_P$NT)
NT_P <- as.data.frame(NT_P[-1])
rownames(NT_P) <- rows
pro.NT_P<- prop.table(as.matrix(NT_P),2)
XsqP <- chisq.test(pro.NT_P)
print(XsqP)
# Para zonas de no pesca
NT_R <- NT2 %>%
ungroup() %>%
filter(Zonificacion == "Zona de no Pesca ") %>%
select(-Zonificacion) %>%
spread(Ano, Abundancia)
rows <- unique(NT_R$NT)
NT_R <- as.data.frame(NT_R[-1])
rownames(NT_R) <- rows
pro.NT_R<- prop.table(as.matrix(NT_R),2)
XsqR <- chisq.test(pro.NT_R)
print(XsqR)
NT <- trophic(data = datos, location = "Bahia de Kino")
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
modelNTP
modelNTR
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
rm(fish_biomass)
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
datos <- datos %>%
mutate(TL = NT)
NT <- trophic(data = datos, location = "Bahia de Kino")
mpa_plot2(NT, "t")
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
NTP
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(NT, na.rm = T)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTP
NT
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTP <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de Pesca ")
modelNTP <- lm(NT ~ Ano, data = NTP)
NTR <- NT %>%
group_by(Ano, Zonificacion) %>%
summarize(NT = mean(mean)) %>%
filter(Zonificacion == "Zona de no Pesca ")
modelNTR <- lm(NT ~ Ano, data = NTR)
stargazer(modelNTP, modelNTR, type = "latex", dep.var.caption = "Densidad", omit.stat = c("n"), keep.stat = "aic", title = "Modelos lineales describiendo cambios en las densidades promedio por zona para (1) Pesca y (2) No Pesca.")
?glmmadmb
install.packages("glmmADMB")
modelNR
summary(modelNR)
install.packages("glmmADMB")
